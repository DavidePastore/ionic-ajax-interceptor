!function(){"use strict";angular.module("ionic-ajax-interceptor",["ionic"])}(),function(n){"use strict";n.provider("AjaxInterceptor",["$httpProvider",function(n){var o={title:"Error",defaultMessage:"Unknown error",authorizationHeader:"Authorization",authorizationToken:null,stateChangeError:!0,fallbackIp:null,requestTransformer:null,responseTransformer:null};return{config:function(r){angular.extend(o,r),n.interceptors.push(["$rootScope","$q","$injector",function(n,r,e){return{request:function(r){return n.$broadcast("loading:show"),o.authorizationToken&&(r.headers[o.authorizationHeader]=o.authorizationToken),r},requestError:function(o){return n.$broadcast("loading:hide"),r.reject(o)},response:function(o){return n.$broadcast("loading:hide"),o},responseError:function(t){if(0==t.status){var a=t.config.url.split("/");if(a[2]!==o.fallbackIp){a[2]=o.fallbackIp,t.config.url=a.join("/");var i=e.get("$http");return i(t.config)}}return n.$broadcast("loading:hide"),r.reject(t)}}}]),o.requestTransformer&&n.defaults.transformRequest.push(o.requestTransformer),o.responseTransformer&&n.defaults.transformResponse.push(o.responseTransformer)},$get:["$ionicPopup","$ionicLoading","$rootScope",function(n,r,e){var t=0,a=function(){0===t&&r.show({content:"Loading",animation:"fade-in",showBackdrop:!0,maxWidth:200,showDelay:0}),t++},i=function(){t--,0==t?r.hide():0>t&&(t=0)};return{run:function(){o.stateChangeError&&e.$on("$stateChangeError",function(r,e,t,a,i,u){n.alert({title:o.title,content:u.message||o.defaultMessage})}),e.$on("loading:show",function(){a()}),e.$on("loading:hide",function(){i()})},setAuthorizationToken:function(n){o.authorizationToken=n},showLoading:function(){a()},hideLoading:function(){i()}}}]}}])}(angular.module("ionic-ajax-interceptor"));